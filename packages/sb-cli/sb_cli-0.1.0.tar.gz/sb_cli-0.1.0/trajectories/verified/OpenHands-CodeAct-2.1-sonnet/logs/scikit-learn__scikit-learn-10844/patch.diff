diff --git a/reproduce_fowlkes_mallows.py b/reproduce_fowlkes_mallows.py
new file mode 100644
index 000000000..3aa9317bc
--- /dev/null
+++ b/reproduce_fowlkes_mallows.py
@@ -0,0 +1,28 @@
+import numpy as np
+import warnings
+warnings.filterwarnings('always')
+from sklearn.metrics.cluster import fowlkes_mallows_score
+
+# Test various edge cases
+def test_case(labels_true, labels_pred, case_name):
+    score = fowlkes_mallows_score(labels_true, labels_pred)
+    print(f"{case_name} - Score: {score}")
+
+# Case 1: Large arrays (original test case)
+n = 1000000
+test_case(np.zeros(n, dtype=int), np.arange(n, dtype=int), "Large arrays")
+
+# Case 2: Perfect match
+test_case([0, 0, 1, 1], [0, 0, 1, 1], "Perfect match")
+
+# Case 3: Perfect match with permutation
+test_case([0, 0, 1, 1], [1, 1, 0, 0], "Perfect match with permutation")
+
+# Case 4: No match
+test_case([0, 0, 0, 0], [0, 1, 2, 3], "No match")
+
+# Case 5: Single element
+test_case([0], [0], "Single element")
+
+# Case 6: Empty arrays
+test_case([], [], "Empty arrays")
\ No newline at end of file
diff --git a/sklearn/metrics/cluster/supervised.py b/sklearn/metrics/cluster/supervised.py
index a987778ae..9bcca75a2 100644
--- a/sklearn/metrics/cluster/supervised.py
+++ b/sklearn/metrics/cluster/supervised.py
@@ -856,7 +856,7 @@ def fowlkes_mallows_score(labels_true, labels_pred, sparse=False):
     tk = np.dot(c.data, c.data) - n_samples
     pk = np.sum(np.asarray(c.sum(axis=0)).ravel() ** 2) - n_samples
     qk = np.sum(np.asarray(c.sum(axis=1)).ravel() ** 2) - n_samples
-    return tk / np.sqrt(pk * qk) if tk != 0. else 0.
+    return np.sqrt(tk / pk) * np.sqrt(tk / qk) if tk != 0. else 0.
 
 
 def entropy(labels):
