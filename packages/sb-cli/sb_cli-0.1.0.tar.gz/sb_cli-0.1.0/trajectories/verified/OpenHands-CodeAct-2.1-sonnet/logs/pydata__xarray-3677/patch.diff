diff --git a/reproduce.py b/reproduce.py
new file mode 100644
index 00000000..c35d758d
--- /dev/null
+++ b/reproduce.py
@@ -0,0 +1,20 @@
+import xarray as xr
+
+ds = xr.Dataset({'a': 0})
+da = xr.DataArray(1, name='b')
+da_noname = xr.DataArray(2)  # DataArray without name
+
+print("Testing top-level merge:")
+expected = xr.merge([ds, da])  # works fine
+print(expected)
+
+print("\nTesting ds.merge() with named DataArray:")
+result1 = ds.merge(da)
+print(result1)
+
+print("\nTesting ds.merge() with unnamed DataArray:")
+try:
+    result2 = ds.merge(da_noname)
+    print(result2)
+except ValueError as e:
+    print("Got expected error for unnamed DataArray:", str(e))
\ No newline at end of file
diff --git a/xarray/core/dataset.py b/xarray/core/dataset.py
index ac0a923d..a59a3918 100644
--- a/xarray/core/dataset.py
+++ b/xarray/core/dataset.py
@@ -3604,6 +3604,9 @@ class Dataset(Mapping, ImplementsDatasetReduce, DataWithCoords):
             If any variables conflict (see ``compat``).
         """
         _check_inplace(inplace)
+        from .dataarray import DataArray
+        if isinstance(other, DataArray):
+            other = other.to_dataset()
         merge_result = dataset_merge_method(
             self,
             other,
