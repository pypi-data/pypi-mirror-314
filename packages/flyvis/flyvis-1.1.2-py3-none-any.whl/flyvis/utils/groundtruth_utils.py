"""Groundtruth data structures for fly visual system cell types.

This module contains various dictionaries and lists that represent groundtruth
information from literature about different cell types in the fly visual system.
The data includes polarity, pathway classification, layout, direction selectivity,
and other properties of various neurons.

Note:
    All data structures are based on published literature and may need to be
    updated as new research becomes available.
"""

# -- polarity ------------------------------------------------------------------

# 1 is ON, 0 is unknown, -1 is OFF
polarity = {
    "R1": 1,
    "R2": 1,
    "R3": 1,
    "R4": 1,
    "R5": 1,
    "R6": 1,
    "R7": 1,
    "R8": 1,
    "L1": -1,
    "L2": -1,
    "L3": -1,
    "L4": -1,
    "L5": 1,  # Drews 2020, Matulis 2020
    "Lawf1": 0,
    "Lawf2": 0,
    "Am": 0,
    "C2": 0,
    "C3": 1,
    "CT1(Lo1)": -1,
    "CT1(M10)": 1,
    "Mi1": 1,
    "Mi2": 0,
    "Mi3": 0,
    "Mi4": 1,
    "Mi9": -1,
    "Mi10": 0,
    "Mi11": 0,
    "Mi12": 0,
    "Mi13": 0,
    "Mi14": 0,
    "Mi15": 0,
    "T1": 0,
    "T2": 0,
    "T2a": 0,
    "T3": 0,
    "T4a": 1,
    "T4b": 1,
    "T4c": 1,
    "T4d": 1,
    "T5a": -1,
    "T5b": -1,
    "T5c": -1,
    "T5d": -1,
    "Tm1": -1,
    "Tm2": -1,
    "Tm3": 1,
    "Tm4": -1,
    "Tm5Y": 0,
    "Tm5a": 0,
    "Tm5b": 0,
    "Tm5c": 0,
    "Tm9": -1,
    "Tm16": 0,
    "Tm20": 0,
    "Tm28": 0,
    "Tm30": 0,
    "TmY3": 0,
    "TmY4": 0,
    "TmY5a": 0,
    "TmY9": 0,
    "TmY10": 0,
    "TmY13": 0,
    "TmY14": 0,
    "TmY15": 0,
    "TmY18": 0,
}

on_pathway = [
    "L1",
    "L3",
    "L5",
    "Mi1",
    "Tm3",
    "Mi4",
    "Mi9",
    "CT1(M10)",
    "T4a",
    "T4b",
    "T4c",
    "T4d",
]
off_pathway = [
    "L2",
    "L3",
    "L4",
    "Tm1",
    "Tm2",
    "Tm4",
    "Tm9",
    "CT1(Lo1)",
    "T5a",
    "T5b",
    "T5c",
    "T5d",
]

layout = {
    "R1": "retina",
    "R2": "retina",
    "R3": "retina",
    "R4": "retina",
    "R5": "retina",
    "R6": "retina",
    "R7": "retina",
    "R8": "retina",
    "L1": "intermediate",
    "L2": "intermediate",
    "L3": "intermediate",
    "L4": "intermediate",
    "L5": "intermediate",
    "Lawf1": "intermediate",
    "Lawf2": "intermediate",
    "Am": "intermediate",
    "C2": "intermediate",
    "C3": "intermediate",
    "CT1(Lo1)": "intermediate",
    "CT1(M10)": "intermediate",
    "Mi1": "intermediate",
    "Mi2": "intermediate",
    "Mi3": "intermediate",
    "Mi4": "intermediate",
    "Mi9": "intermediate",
    "Mi10": "intermediate",
    "Mi11": "intermediate",
    "Mi12": "intermediate",
    "Mi13": "intermediate",
    "Mi14": "intermediate",
    "Mi15": "intermediate",
    "T4a": "output",
    "T4b": "output",
    "T4c": "output",
    "T4d": "output",
    "T1": "output",
    "T2": "output",
    "T2a": "output",
    "T3": "output",
    "T5a": "output",
    "T5b": "output",
    "T5c": "output",
    "T5d": "output",
    "Tm1": "output",
    "Tm2": "output",
    "Tm3": "output",
    "Tm4": "output",
    "Tm5Y": "output",
    "Tm5a": "output",
    "Tm5b": "output",
    "Tm5c": "output",
    "Tm9": "output",
    "Tm16": "output",
    "Tm20": "output",
    "Tm28": "output",
    "Tm30": "output",
    "TmY3": "output",
    "TmY4": "output",
    "TmY5a": "output",
    "TmY9": "output",
    "TmY10": "output",
    "TmY13": "output",
    "TmY14": "output",
    "TmY15": "output",
    "TmY18": "output",
}

preferred_directions = {
    "T4a": 180,
    "T4b": 0,
    "T4c": 90,
    "T4d": 270,
    "T5a": 180,
    "T5b": 0,
    "T5c": 90,
    "T5d": 270,
}

on_direction_selective = {
    "R1": 0,
    "R2": 0,
    "R3": 0,
    "R4": 0,
    "R5": 0,
    "R6": 0,
    "R7": 0,
    "R8": 0,
    "L1": 0,
    "L2": 0,
    "L3": 0,
    "L4": 0,
    "L5": 0,
    "Lawf1": 0,
    "Lawf2": 0,
    "Am": 0,
    "C2": 0,
    "C3": 0,
    "CT1(Lo1)": 0,
    "CT1(M10)": 0,
    "Mi1": 0,
    "Mi2": 0,
    "Mi3": 0,
    "Mi4": 0,
    "Mi9": 0,
    "Mi10": 0,
    "Mi11": 0,
    "Mi12": 0,
    "Mi13": 0,
    "Mi14": 0,
    "Mi15": 0,
    "T1": 0,
    "T2": 0,
    "T2a": 0,
    "T3": 0,
    "T4a": 1,
    "T4b": 1,
    "T4c": 1,
    "T4d": 1,
    "T5a": 0,
    "T5b": 0,
    "T5c": 0,
    "T5d": 0,
    "Tm1": 0,
    "Tm2": 0,
    "Tm3": 0,
    "Tm4": 0,
    "Tm5Y": 0,
    "Tm5a": 0,
    "Tm5b": 0,
    "Tm5c": 0,
    "Tm9": 0,
    "Tm16": 0,
    "Tm20": 0,
    "Tm28": 0,
    "Tm30": 0,
    "TmY3": 0,
    "TmY4": 0,
    "TmY5a": 0,
    "TmY9": 0,
    "TmY10": 0,
    "TmY13": 0,
    "TmY14": 0,
    "TmY15": 0,
    "TmY18": 0,
}

off_direction_selective = {
    "R1": 0,
    "R2": 0,
    "R3": 0,
    "R4": 0,
    "R5": 0,
    "R6": 0,
    "R7": 0,
    "R8": 0,
    "L1": 0,
    "L2": 0,
    "L3": 0,
    "L4": 0,
    "L5": 0,
    "Lawf1": 0,
    "Lawf2": 0,
    "Am": 0,
    "C2": 0,
    "C3": 0,
    "CT1(Lo1)": 0,
    "CT1(M10)": 0,
    "Mi1": 0,
    "Mi2": 0,
    "Mi3": 0,
    "Mi4": 0,
    "Mi9": 0,
    "Mi10": 0,
    "Mi11": 0,
    "Mi12": 0,
    "Mi13": 0,
    "Mi14": 0,
    "Mi15": 0,
    "T1": 0,
    "T2": 0,
    "T2a": 0,
    "T3": 0,
    "T4a": 0,
    "T4b": 0,
    "T4c": 0,
    "T4d": 0,
    "T5a": 1,
    "T5b": 1,
    "T5c": 1,
    "T5d": 1,
    "Tm1": 0,
    "Tm2": 0,
    "Tm3": 0,
    "Tm4": 0,
    "Tm5Y": 0,
    "Tm5a": 0,
    "Tm5b": 0,
    "Tm5c": 0,
    "Tm9": 0,
    "Tm16": 0,
    "Tm20": 0,
    "Tm28": 0,
    "Tm30": 0,
    "TmY3": 0,
    "TmY4": 0,
    "TmY5a": 0,
    "TmY9": 0,
    "TmY10": 0,
    "TmY13": 0,
    "TmY14": 0,
    "TmY15": 0,
    "TmY18": 0,
}

not_direction_selective = {
    "R1": 0,
    "R2": 0,
    "R3": 0,
    "R4": 0,
    "R5": 0,
    "R6": 0,
    "R7": 0,
    "R8": 0,
    "L1": 0,
    "L2": 0,
    "L3": 0,
    "L4": 0,
    "L5": 0,
    "Lawf1": 0,
    "Lawf2": 0,
    "Am": 0,
    "C2": 0,
    "C3": 0,
    "CT1(Lo1)": 1,
    "CT1(M10)": 1,
    "Mi1": 1,
    "Mi2": 0,
    "Mi3": 0,
    "Mi4": 1,
    "Mi9": 1,
    "Mi10": 0,
    "Mi11": 0,
    "Mi12": 0,
    "Mi13": 0,
    "Mi14": 0,
    "Mi15": 0,
    "T1": 0,
    "T2": 0,
    "T2a": 0,
    "T3": 0,
    "T4a": 0,
    "T4b": 0,
    "T4c": 0,
    "T4d": 0,
    "T5a": 0,
    "T5b": 0,
    "T5c": 0,
    "T5d": 0,
    "Tm1": 1,
    "Tm2": 1,
    "Tm3": 1,
    "Tm4": 1,
    "Tm5Y": 0,
    "Tm5a": 0,
    "Tm5b": 0,
    "Tm5c": 0,
    "Tm9": 1,
    "Tm16": 0,
    "Tm20": 0,
    "Tm28": 0,
    "Tm30": 0,
    "TmY3": 0,
    "TmY4": 0,
    "TmY5a": 0,
    "TmY9": 0,
    "TmY10": 0,
    "TmY13": 0,
    "TmY14": 0,
    "TmY15": 0,
    "TmY18": 0,
}


asymmetric_input = {
    "R1": 0,
    "R2": 0,
    "R3": 0,
    "R4": 0,
    "R5": 0,
    "R6": 0,
    "R7": 0,
    "R8": 0,
    "L1": 0,
    "L2": 0,
    "L3": 0,
    "L4": 0,
    "L5": 0,
    "Lawf1": 0,
    "Lawf2": 0,
    "Am": 0,
    "C2": 0,
    "C3": 0,
    "CT1(Lo1)": 0,
    "CT1(M10)": 0,
    "Mi1": 0,
    "Mi2": 0,
    "Mi3": 0,
    "Mi4": 0,
    "Mi9": 0,
    "Mi10": 0,
    "Mi11": 0,
    "Mi12": 0,
    "Mi13": 0,
    "Mi14": 0,
    "Mi15": 0,
    "T1": 0,
    "T2": 1,
    "T2a": 1,
    "T3": 1,
    "T4a": 1,
    "T4b": 1,
    "T4c": 1,
    "T4d": 1,
    "T5a": 1,
    "T5b": 1,
    "T5c": 1,
    "T5d": 1,
    "Tm1": 0,
    "Tm2": 0,
    "Tm3": 1,
    "Tm4": 1,
    "Tm5Y": 0,
    "Tm5a": 0,
    "Tm5b": 0,
    "Tm5c": 0,
    "Tm9": 0,
    "Tm16": 0,
    "Tm20": 0,
    "Tm28": 0,
    "Tm30": 0,
    "TmY3": 1,
    "TmY4": 1,
    "TmY5a": 1,
    "TmY9": 0,
    "TmY10": 0,
    "TmY13": 0,
    "TmY14": 1,
    "TmY15": 1,
    "TmY18": 1,
}
unsufficient_data = [
    "Tm5a",
    "Tm5b",
    "Tm5c",
    "Tm16",
    "Tm28",
    "Tm30",
    "TmY9",
    "TmY10",
    "TmY13",
]
noisy_data = ["Tm1", "Tm2", "Tm5Y", "Tm9"]

symmetric_inputs = [
    cell_type
    for cell_type, v in asymmetric_input.items()
    if (v == 0 and cell_type not in unsufficient_data and cell_type not in noisy_data)
]


### for correlation to tuning metrics

# no motion tuning in T4 and T5 inputs
no_motion_tuning = [
    #     "L2",
    #     "L3",
    #     "L4",
    "Tm1",
    "Tm2",
    "Tm4",
    "Tm9",
    "CT1(Lo1)",
    #     "L1",
    #     "L3",
    #     "L5",
    "Mi1",
    "Tm3",
    "Mi4",
    "Mi9",
    "CT1(M10)",
]

motion_tuning = ["T5a", "T5b", "T5c", "T5d", "T4a", "T4b", "T4c", "T4d"]
on_motion_tuning = ["T4a", "T4b", "T4c", "T4d"]
off_motion_tuning = ["T5a", "T5b", "T5c", "T5d"]

known_dsi_types = [*no_motion_tuning, *motion_tuning]

known_preferred_contrasts = {k: v for k, v in polarity.items() if v in [-1, 1]}

# from Maisak et al. 2013 Fig. 3 g, h
tuning_curves = dict(
    # T4
    T4b=[
        0.745,
        0.785,
        0.305,
        0.265,
        0.25,
        0.335,
        0.285,
        0.23,
        0.14,
        0.11,
        0.26,
        0.775,
    ],
    T4a=[
        0.04,
        0.05,
        0.165,
        0.19,
        0.29,
        0.50,
        1.0,
        0.585,
        0.31,
        0.11,
        0.06,
        0.04,
    ],
    T4c=[
        0.04,
        0.2,
        0.57,
        0.775,
        0.715,
        0.325,
        0.22,
        0.13,
        0.13,
        0.22,
        0.155,
        0.11,
    ],
    T4d=[
        0.07,
        0.07,
        0.12,
        0.17,
        0.21,
        0.14,
        0.21,
        0.29,
        0.67,
        0.655,
        0.7,
        0.510,
    ],
    # T5
    T5b=[
        0.83,
        0.855,
        0.405,
        0.16,
        0.175,
        0.24,
        0.30,
        0.25,
        0.13,
        0.2,
        0.30,
        0.655,
    ],
    T5a=[
        0.20,
        0.295,
        0.265,
        0.20,
        0.25,
        0.65,
        1.0,
        0.59,
        0.29,
        0.21,
        0.20,
        0.22,
    ],
    T5c=[
        0.20,
        0.44,
        0.69,
        0.595,
        0.745,
        0.525,
        0.34,
        0.255,
        0.34,
        0.295,
        0.26,
        0.28,
    ],
    T5d=[
        0.17,
        0.21,
        0.21,
        0.20,
        0.19,
        0.15,
        0.185,
        0.42,
        0.85,
        0.79,
        0.685,
        0.565,
    ],
)
