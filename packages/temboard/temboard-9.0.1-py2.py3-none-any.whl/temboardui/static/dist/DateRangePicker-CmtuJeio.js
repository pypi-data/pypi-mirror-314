import{p as y,c as V,q as Q,o as _,e as b,z as o,f as d,g as q,P as x,R as re,U as G,V as A,F as I,A as U,j as le,h as de,n as ue}from"./vue-DqMao7g8.js";import"./daterangepicker-i3LpM03M.js";import{$ as D}from"./jquery-BALIvAru.js";import{l as P}from"./lodash-uc_7-CSk.js";import{m as p}from"./moment-CMyQs7Vz.js";import{b as ce,u as fe}from"./vue-router-CCNp7My1.js";var pe=["y","M","w","d","h","m","s"];function J(e,a,n){if(e){if(p.isMoment(e))return e;if(P.isDate(e))return p(e);var i,s="",c,u;return e.substring(0,3)==="now"?(n==="utc"?i=p.utc():i=p(),s=e.substring(3)):(c=e.indexOf("||"),c===-1?(u=e,s=""):(u=e.substring(0,c),s=e.substring(c+2)),i=p(u,p.ISO_8601)),s.length?ve(s,i,a):i}}function me(e){var a=J(e);return a&&p.isMoment(a)?a.isValid():!1}function ve(e,a,n){for(var i=a,s=0,c=e.length;s<c;){var u=e.charAt(s++),m,h,v;if(u==="/")m=0;else if(u==="+")m=1;else if(u==="-")m=2;else return;if(isNaN(e.charAt(s)))h=1;else if(e.length===2)h=e.charAt(s);else{for(var l=s;!isNaN(e.charAt(s));)if(s++,s>10)return;h=parseInt(e.substring(l,s),10)}if(m===0&&h!==1)return;if(v=e.charAt(s++),P.includes(pe,v))m===0?n?i.endOf(v):i.startOf(v):m===1?i.add(h,v):m===2&&i.subtract(h,v);else return}return i}const k={parse:J,isValid:me};var we={s:{display:"second"},m:{display:"minute"},h:{display:"hour"},d:{display:"day"},w:{display:"week"},M:{display:"month"},y:{display:"year"}},K=[{from:"now/d",to:"now/d",display:"Today",section:2},{from:"now/d",to:"now",display:"Today so far",section:2},{from:"now/w",to:"now/w",display:"This week",section:2},{from:"now/w",to:"now",display:"This week so far",section:2},{from:"now/M",to:"now/M",display:"This month",section:2},{from:"now/M",to:"now",display:"This month so far",section:2},{from:"now/y",to:"now/y",display:"This year",section:2},{from:"now/y",to:"now",display:"This year so far",section:2},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday",section:1},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday",section:1},{from:"now-7d/d",to:"now-7d/d",display:"This day last week",section:1},{from:"now-1w/w",to:"now-1w/w",display:"Previous week",section:1},{from:"now-1M/M",to:"now-1M/M",display:"Previous month",section:1},{from:"now-1y/y",to:"now-1y/y",display:"Previous year",section:1},{from:"now-5m",to:"now",display:"Last 5 minutes",section:3},{from:"now-15m",to:"now",display:"Last 15 minutes",section:3},{from:"now-30m",to:"now",display:"Last 30 minutes",section:3},{from:"now-1h",to:"now",display:"Last 1 hour",section:3},{from:"now-3h",to:"now",display:"Last 3 hours",section:3},{from:"now-6h",to:"now",display:"Last 6 hours",section:3},{from:"now-12h",to:"now",display:"Last 12 hours",section:3},{from:"now-24h",to:"now",display:"Last 24 hours",section:3},{from:"now-2d",to:"now",display:"Last 2 days",section:0},{from:"now-7d",to:"now",display:"Last 7 days",section:0},{from:"now-30d",to:"now",display:"Last 30 days",section:0},{from:"now-90d",to:"now",display:"Last 90 days",section:0},{from:"now-6M",to:"now",display:"Last 6 months",section:0},{from:"now-1y",to:"now",display:"Last 1 year",section:0},{from:"now-2y",to:"now",display:"Last 2 years",section:0},{from:"now-5y",to:"now",display:"Last 5 years",section:0}],ye="MMM D, YYYY HH:mm:ss",Y={};P.each(K,function(e){Y[e.from+" to "+e.to]=e});function he(e,a){var n=P.groupBy(K,function(i){return i.active=i.display===a,i.section});return n}function C(e){return e.format(ye)}function _e(e){var a=e.indexOf("+")!==0;e.indexOf("now")===-1&&(e=(a?"now-":"now")+e);var n=Y[e+" to now"];if(n)return n;a?n={from:e,to:"now"}:n={from:"now",to:e};var i=/^now([-+])(\d+)(\w)/.exec(e);if(i){var s=i[3],c=parseInt(i[2]),u=we[s];u&&(n.display=a?"Last ":"Next ",n.display+=c+" "+u.display,n.section=u.section,c>1&&(n.display+="s"))}else n.display=n.from+" to "+n.to,n.invalid=!0;return n}function be(e){var a=Y[e.from.toString()+" to "+e.to.toString()];if(a)return a.display;if(p.isMoment(e.from)&&p.isMoment(e.to))return C(e.from)+" to "+C(e.to);if(p.isMoment(e.from)){var n=k.parse(e.to,!0);return C(e.from)+" to "+n.fromNow()}if(p.isMoment(e.to)){var i=k.parse(e.from,!1);return i.fromNow()+" to "+C(e.to)}if(e.to.toString()==="now"){var s=_e(e.from);return s.display}return e.from.toString()+" to "+e.to.toString()}const E={describeTimeRange:be,getRelativeTimesList:he},ke=o("i",{class:"fa fa-clock-o"},null,-1),ge={class:"row position-absolute bg-light border rounded card-body picker-dropdown-panel m-1 w-100 shadow p-3"},Te={class:"col-4"},Me=o("h3",null,"Custom range",-1),Le={class:"mb-3"},De=o("label",{for:"inputFrom",class:"form-label"},"From:",-1),Pe={class:"input-group"},Re=o("div",{class:"input-group-text","data-role":"from-picker"},[o("i",{class:"fa fa-calendar"})],-1),Fe={class:"mb-3"},Oe=o("label",{for:"inputTo",class:"form-label"},"To:",-1),qe={class:"input-group"},Ae=o("div",{class:"input-group-text","data-role":"to-picker"},[o("i",{class:"fa fa-calendar"})],-1),Ce={class:"col-8 ps-4"},Se=o("h3",null,"Quick ranges",-1),Ne={class:"row"},Ve={class:"list-unstyled col"},xe={class:"shortcut"},Ie=["data-from","data-to","onClick"],Ue={class:"btn-group"},Ee=["disabled"],Ye=o("i",{class:"fa fa-refresh"},null,-1),$e=[Ye],Be=["disabled"],He={key:0,class:"text-warning"},ze={class:"dropdown-menu dropdown-menu-end",style:{"min-width":"50px"}},je=o("div",{class:"dropdown-divider"},null,-1),Qe=["onClick"],eo={__name:"DateRangePicker",emits:["fromtoUpdated"],setup(e,{expose:a,emit:n}){const i=n,s=ce(),c=fe();let u,m;const h=y(E.getRelativeTimesList()),v=y(null),l=y(null),f=y(null),g=y(null),R=y(null),T=y(null),$=y({60:"1m",300:"5m",900:"15m"}),F=y(!1);let B;const W=V(()=>""+l.value+f.value),S=V(()=>l.value&&l.value.toString().indexOf("now")!=-1||f.value&&f.value.toString().indexOf("now")!=-1);Q(W,()=>{s.push({path:c.path,query:P.assign({},c.query,{start:""+l.value,end:""+f.value})}),g.value=l.value,R.value=f.value}),Q(T,M),s.afterEach(t=>{!t.query.start||!t.query.end||(t.query.start&&(l.value=O(t.query.start)),t.query.end&&(f.value=O(t.query.end)),M())});const X=V(()=>{if(!(!l.value||!f.value))return E.describeTimeRange({from:l.value,to:f.value})});s.isReady().then(()=>{const t=c.query.start||"now-24h",r=c.query.end||"now";l.value=O(t),f.value=O(r),j(),te()});function O(t){const r=parseInt(t,10);return P.isFinite(r)?p(r):t}function Z(t){l.value=t.from,f.value=t.to,F.value=!1,M()}function ee(){F.value=!F.value}function H(t){if(p.isMoment(t))return t;const r=p(new Date(t));return r.isValid()?r:t}function oe(){F.value=!1,l.value=H(g.value),f.value=H(R.value),M()}const N={singleDatePicker:!0,timePicker:!0,timePicker24Hour:!0,timePickerSeconds:!1};function te(){(!u||!u.data("daterangepicker").isShowing)&&(u=D(v.value).find("[data-role=from-picker]").daterangepicker(D.extend({startDate:k.parse(l.value)},N),ne)),(!m||!m.data("daterangepicker").isShowing)&&(m=D(v.value).find("[data-role=to-picker]").daterangepicker(D.extend({startDate:k.parse(f.value),minDate:k.parse(l.value)},N),z))}function se(){D(v.value).find("[data-role=to-picker]").daterangepicker(D.extend({minDate:k.parse(g.value)},N),z)}function ne(t){g.value=t,se()}function z(t){R.value=t}function M(){j(),clearTimeout(B),T.value&&(B=window.setTimeout(M,T.value*1e3))}function ie(t,r){l.value=t,f.value=r}a({setFromTo:ie});function j(){i("fromtoUpdated",k.parse(l.value),k.parse(f.value,!0))}return(t,r)=>(_(),b("div",{ref_key:"rootEl",ref:v},[o("button",{id:"buttonPicker",class:"btn btn-secondary",onClick:ee},[ke,d(`Â 
      `),o("span",null,q(X.value),1)]),d(),x(o("div",ge,[o("div",Te,[Me,d(),o("form",null,[o("div",Le,[De,d(),o("div",Pe,[x(o("input",{type:"text",id:"inputFrom","onUpdate:modelValue":r[0]||(r[0]=w=>g.value=w),class:"form-control"},null,512),[[G,g.value]]),d(),Re])]),d(),o("div",Fe,[Oe,d(),o("div",qe,[x(o("input",{type:"text",id:"inputTo","onUpdate:modelValue":r[1]||(r[1]=w=>R.value=w),class:"form-control"},null,512),[[G,R.value]]),d(),Ae])]),d(),o("div",null,[o("button",{class:"btn btn-primary",onClick:A(oe,["prevent"])},"Apply")])])]),d(),o("div",Ce,[Se,d(),o("div",Ne,[(_(!0),b(I,null,U(h.value,w=>(_(),b("ul",Ve,[(_(!0),b(I,null,U(w,L=>(_(),b("li",xe,[o("a",{href:"","data-from":L.from,"data-to":L.to,onClick:A(ae=>Z(L),["prevent"])},q(le(E).describeTimeRange(L)),9,Ie)]))),256))]))),256))])])],512),[[re,F.value]]),d(),o("div",Ue,[o("button",{id:"buttonRefresh",class:"btn btn-secondary",onClick:r[2]||(r[2]=w=>M()),disabled:!S.value},$e,8,Ee),d(),o("button",{id:"buttonAutoRefresh",type:"button",class:"btn btn-secondary dropdown-toggle","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:!S.value},[S.value?(_(),b("span",He,q($.value[T.value]),1)):de("",!0)],8,Be),d(),o("div",ze,[o("a",{class:"dropdown-item refresh-off",href:"",onClick:r[3]||(r[3]=A(w=>T.value=null,["prevent"]))},"Off"),d(),je,d(),(_(!0),b(I,null,U($.value,(w,L)=>(_(),b("a",{class:ue("dropdown-item refresh-"+w),href:"",onClick:A(ae=>T.value=L,["prevent"])},q(w),11,Qe))),256))])])],512))}};export{eo as _};
