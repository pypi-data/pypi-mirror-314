import{s as it,e as g,c as h,b as k,f as p,y as kt,o as b,i as U,h as u,z as Xe,A as $e,n as xe,B as Et,C as yt,G as Dt,t as Ct,a as z,d as It,g as B,D as et,j as Vt,E as Tt,r as L,m as ie,v as ze,w as M,F as tt}from"../chunks/scheduler.BVk0_e6s.js";import{S as rt,i as dt,b as O,c as ke,d as Ee,m as ye,t as ne,a as re,e as Ht,f as De,g as Lt}from"../chunks/index.B3JOrRZV.js";import{S as Mt,B as Ot,b as St,c as jt,f as zt}from"../chunks/utils.CCASYkbs.js";import{e as ot}from"../chunks/each.D6YF6ztN.js";import{g as oe}from"../chunks/variables.DuLSJ-pC.js";function nt(e,n,t){const d=e.slice();return d[8]=n[t],d}function lt(e){let n,t=e[8]+"",d,l,v;return{c(){n=g("option"),d=Ct(t),l=z(),this.h()},l(_){n=h(_,"OPTION",{});var s=k(n);d=It(s,t),l=B(s),s.forEach(p),this.h()},h(){n.__value=v=e[8],et(n,n.__value)},m(_,s){U(_,n,s),u(n,d),u(n,l)},p(_,s){s&2&&t!==(t=_[8]+"")&&Vt(d,t),s&2&&v!==(v=_[8])&&(n.__value=v,et(n,n.__value))},d(_){_&&p(n)}}}function Bt(e){let n,t,d,l,v,_=ot(e[1]),s=[];for(let r=0;r<_.length;r+=1)s[r]=lt(nt(e,_,r));return{c(){n=g("div"),t=g("select");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){n=h(r,"DIV",{class:!0});var a=k(n);t=h(a,"SELECT",{});var i=k(t);for(let w=0;w<s.length;w+=1)s[w].l(i);i.forEach(p),a.forEach(p),this.h()},h(){t.disabled=d=!e[2],e[0]===void 0&&kt(()=>e[4].call(t)),b(n,"class","dropdown")},m(r,a){U(r,n,a),u(n,t);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(t,null);Xe(t,e[0],!0),l||(v=[$e(t,"change",e[4]),$e(t,"change",e[5])],l=!0)},p(r,[a]){if(a&2){_=ot(r[1]);let i;for(i=0;i<_.length;i+=1){const w=nt(r,_,i);s[i]?s[i].p(w,a):(s[i]=lt(w),s[i].c(),s[i].m(t,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=_.length}a&4&&d!==(d=!r[2])&&(t.disabled=d),a&3&&Xe(t,r[0])},i:xe,o:xe,d(r){r&&p(n),Et(s,r),l=!1,yt(v)}}}function Pt(e,n,t){let{options:d}=n,{selected_option:l=d[0]}=n,{enabled:v=!0}=n;d.join("_");const _=Dt();function s(){_("selection-changed",l)}function r(){l=Tt(this),t(0,l),t(1,d)}const a=()=>s();return e.$$set=i=>{"options"in i&&t(1,d=i.options),"selected_option"in i&&t(0,l=i.selected_option),"enabled"in i&&t(2,v=i.enabled)},[l,d,v,s,r,a]}class Ne extends rt{constructor(n){super(),dt(this,n,Pt,Bt,it,{options:1,selected_option:0,enabled:2})}}function st(e){let n,t='<div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){n=g("div"),n.innerHTML=t,this.h()},l(d){n=h(d,"DIV",{class:!0,"data-svelte-h":!0}),ie(n)!=="svelte-57s7b4"&&(n.innerHTML=t),this.h()},h(){b(n,"class","text-center")},m(d,l){U(d,n,l)},d(d){d&&p(n)}}}function at(e){let n,t,d,l,v;function _(a){e[25](a)}function s(a){e[26](a)}let r={zoom:!0};return e[11]!==void 0&&(r.config=e[11]),e[10]!==void 0&&(r.plot_name=e[10]),t=new Ot({props:r}),L.push(()=>O(t,"config",_)),L.push(()=>O(t,"plot_name",s)),{c(){n=g("div"),ke(t.$$.fragment),this.h()},l(a){n=h(a,"DIV",{style:!0});var i=k(n);Ee(t.$$.fragment,i),i.forEach(p),this.h()},h(){ze(n,"position","relative")},m(a,i){U(a,n,i),ye(t,n,null),v=!0},p(a,i){const w={};!d&&i&2048&&(d=!0,w.config=a[11],M(()=>d=!1)),!l&&i&1024&&(l=!0,w.plot_name=a[10],M(()=>l=!1)),t.$set(w)},i(a){v||(ne(t.$$.fragment,a),v=!0)},o(a){re(t.$$.fragment,a),v=!1},d(a){a&&p(n),De(t)}}}function qt(e){let n,t='<div class="col"><h2>The Energy Balance</h2></div>',d,l,v,_,s,r,a,i='<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button>',w,D,I,y,X,de,V,he,ce,be,G,Z,Ce='<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Data selection</button>',ve,N,S,$,W,x,Ie="Year",me,H,f,K,ue,R,j,ee,le="Node",P,T,we,_e,c,q,te,fe,We="Carrier",Be,A,Pe,qe,Ve,se,F,Te,He;function ct(o){e[14](o)}function ut(o){e[15](o)}function _t(o){e[16](o)}function ft(o){e[17](o)}function pt(o){e[18](o)}let pe={enabled:!e[2]&&!e[3]};e[6]!==void 0&&(pe.carriers=e[6]),e[4]!==void 0&&(pe.nodes=e[4]),e[8]!==void 0&&(pe.years=e[8]),e[0]!==void 0&&(pe.selected_solution=e[0]),e[2]!==void 0&&(pe.loading=e[2]),y=new Mt({props:pe}),L.push(()=>O(y,"carriers",ct)),L.push(()=>O(y,"nodes",ut)),L.push(()=>O(y,"years",_t)),L.push(()=>O(y,"selected_solution",ft)),L.push(()=>O(y,"loading",pt)),y.$on("solution_selected",e[12]);function gt(o){e[19](o)}function ht(o){e[20](o)}let Ae={enabled:!e[3]&&!e[2]};e[8]!==void 0&&(Ae.options=e[8]),e[9]!==void 0&&(Ae.selected_option=e[9]),H=new Ne({props:Ae}),L.push(()=>O(H,"options",gt)),L.push(()=>O(H,"selected_option",ht)),H.$on("selection-changed",e[13]);function bt(o){e[21](o)}function vt(o){e[22](o)}let Fe={enabled:!e[3]&&!e[2]};e[4]!==void 0&&(Fe.options=e[4]),e[5]!==void 0&&(Fe.selected_option=e[5]),T=new Ne({props:Fe}),L.push(()=>O(T,"options",bt)),L.push(()=>O(T,"selected_option",vt)),T.$on("selection-changed",e[13]);function mt(o){e[23](o)}function wt(o){e[24](o)}let Ge={enabled:!e[3]&&!e[2]};e[6]!==void 0&&(Ge.options=e[6]),e[7]!==void 0&&(Ge.selected_option=e[7]),A=new Ne({props:Ge}),L.push(()=>O(A,"options",mt)),L.push(()=>O(A,"selected_option",wt)),A.$on("selection-changed",e[13]);let C=e[3]&&st(),E=!e[3]&&e[1]&&at(e);return{c(){n=g("div"),n.innerHTML=t,d=z(),l=g("div"),v=g("div"),_=g("div"),s=g("div"),r=g("div"),a=g("h2"),a.innerHTML=i,w=z(),D=g("div"),I=g("div"),ke(y.$$.fragment),be=z(),G=g("div"),Z=g("h2"),Z.innerHTML=Ce,ve=z(),N=g("div"),S=g("div"),$=g("div"),W=g("div"),x=g("h3"),x.textContent=Ie,me=z(),ke(H.$$.fragment),ue=z(),R=g("div"),j=g("div"),ee=g("h3"),ee.textContent=le,P=z(),ke(T.$$.fragment),c=z(),q=g("div"),te=g("div"),fe=g("h3"),fe.textContent=We,Be=z(),ke(A.$$.fragment),Ve=z(),se=g("div"),F=g("div"),C&&C.c(),Te=z(),E&&E.c(),this.h()},l(o){n=h(o,"DIV",{class:!0,"data-svelte-h":!0}),ie(n)!=="svelte-1d6fcfp"&&(n.innerHTML=t),d=B(o),l=h(o,"DIV",{class:!0});var m=k(l);v=h(m,"DIV",{class:!0});var Y=k(v);_=h(Y,"DIV",{class:!0,style:!0});var ae=k(_);s=h(ae,"DIV",{class:!0,id:!0});var J=k(s);r=h(J,"DIV",{class:!0});var Q=k(r);a=h(Q,"H2",{class:!0,"data-svelte-h":!0}),ie(a)!=="svelte-1oln34a"&&(a.innerHTML=i),w=B(Q),D=h(Q,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var Ke=k(D);I=h(Ke,"DIV",{class:!0});var Re=k(I);Ee(y.$$.fragment,Re),Re.forEach(p),Ke.forEach(p),Q.forEach(p),be=B(J),G=h(J,"DIV",{class:!0});var Le=k(G);Z=h(Le,"H2",{class:!0,"data-svelte-h":!0}),ie(Z)!=="svelte-1huxmzt"&&(Z.innerHTML=Ce),ve=B(Le),N=h(Le,"DIV",{id:!0,class:!0,"data-bs-parent":!0});var Ye=k(N);S=h(Ye,"DIV",{class:!0});var ge=k(S);$=h(ge,"DIV",{class:!0});var Ze=k($);W=h(Ze,"DIV",{class:!0});var Me=k(W);x=h(Me,"H3",{"data-svelte-h":!0}),ie(x)!=="svelte-r9e7qt"&&(x.textContent=Ie),me=B(Me),Ee(H.$$.fragment,Me),Me.forEach(p),Ze.forEach(p),ue=B(ge),R=h(ge,"DIV",{class:!0});var Je=k(R);j=h(Je,"DIV",{class:!0});var Oe=k(j);ee=h(Oe,"H3",{"data-svelte-h":!0}),ie(ee)!=="svelte-ocjo5w"&&(ee.textContent=le),P=B(Oe),Ee(T.$$.fragment,Oe),Oe.forEach(p),Je.forEach(p),c=B(ge),q=h(ge,"DIV",{class:!0});var Qe=k(q);te=h(Qe,"DIV",{class:!0});var Se=k(te);fe=h(Se,"H3",{"data-svelte-h":!0}),ie(fe)!=="svelte-xc22hm"&&(fe.textContent=We),Be=B(Se),Ee(A.$$.fragment,Se),Se.forEach(p),Qe.forEach(p),ge.forEach(p),Ye.forEach(p),Le.forEach(p),J.forEach(p),ae.forEach(p),Y.forEach(p),m.forEach(p),Ve=B(o),se=h(o,"DIV",{class:!0});var Ue=k(se);F=h(Ue,"DIV",{class:!0,style:!0});var je=k(F);C&&C.l(je),Te=B(je),E&&E.l(je),je.forEach(p),Ue.forEach(p),this.h()},h(){b(n,"class","row"),b(a,"class","accordion-header"),b(I,"class","accordion-body"),b(D,"id","collapseOne"),b(D,"class","accordion-collapse collapse show"),b(D,"data-bs-parent","#accordionExample"),b(r,"class","accordion-item solution-selection"),b(Z,"class","accordion-header"),b(W,"class","col-6"),b($,"class","row"),b(j,"class","col-6"),b(R,"class","row"),b(te,"class","col-6"),b(q,"class","row"),b(S,"class","accordion-body"),b(N,"id","collapseTwo"),b(N,"class","accordion-collapse collapse"),b(N,"data-bs-parent","#accordionExample"),b(G,"class","accordion-item"),b(s,"class","accordion"),b(s,"id","accordionExample"),b(_,"class","filters"),ze(_,"position","absolute"),ze(_,"width","100%"),b(v,"class","col position-relative"),b(l,"class","row"),b(F,"class","col"),ze(F,"margin-top","400px"),b(se,"class","row")},m(o,m){U(o,n,m),U(o,d,m),U(o,l,m),u(l,v),u(v,_),u(_,s),u(s,r),u(r,a),u(r,w),u(r,D),u(D,I),ye(y,I,null),u(s,be),u(s,G),u(G,Z),u(G,ve),u(G,N),u(N,S),u(S,$),u($,W),u(W,x),u(W,me),ye(H,W,null),u(S,ue),u(S,R),u(R,j),u(j,ee),u(j,P),ye(T,j,null),u(S,c),u(S,q),u(q,te),u(te,fe),u(te,Be),ye(A,te,null),U(o,Ve,m),U(o,se,m),u(se,F),C&&C.m(F,null),u(F,Te),E&&E.m(F,null),He=!0},p(o,[m]){const Y={};m&12&&(Y.enabled=!o[2]&&!o[3]),!X&&m&64&&(X=!0,Y.carriers=o[6],M(()=>X=!1)),!de&&m&16&&(de=!0,Y.nodes=o[4],M(()=>de=!1)),!V&&m&256&&(V=!0,Y.years=o[8],M(()=>V=!1)),!he&&m&1&&(he=!0,Y.selected_solution=o[0],M(()=>he=!1)),!ce&&m&4&&(ce=!0,Y.loading=o[2],M(()=>ce=!1)),y.$set(Y);const ae={};m&12&&(ae.enabled=!o[3]&&!o[2]),!f&&m&256&&(f=!0,ae.options=o[8],M(()=>f=!1)),!K&&m&512&&(K=!0,ae.selected_option=o[9],M(()=>K=!1)),H.$set(ae);const J={};m&12&&(J.enabled=!o[3]&&!o[2]),!we&&m&16&&(we=!0,J.options=o[4],M(()=>we=!1)),!_e&&m&32&&(_e=!0,J.selected_option=o[5],M(()=>_e=!1)),T.$set(J);const Q={};m&12&&(Q.enabled=!o[3]&&!o[2]),!Pe&&m&64&&(Pe=!0,Q.options=o[6],M(()=>Pe=!1)),!qe&&m&128&&(qe=!0,Q.selected_option=o[7],M(()=>qe=!1)),A.$set(Q),o[3]?C||(C=st(),C.c(),C.m(F,Te)):C&&(C.d(1),C=null),!o[3]&&o[1]?E?(E.p(o,m),m&10&&ne(E,1)):(E=at(o),E.c(),ne(E,1),E.m(F,null)):E&&(Lt(),re(E,1,1,()=>{E=null}),Ht())},i(o){He||(ne(y.$$.fragment,o),ne(H.$$.fragment,o),ne(T.$$.fragment,o),ne(A.$$.fragment,o),ne(E),He=!0)},o(o){re(y.$$.fragment,o),re(H.$$.fragment,o),re(T.$$.fragment,o),re(A.$$.fragment,o),re(E),He=!1},d(o){o&&(p(n),p(d),p(l),p(Ve),p(se)),De(y),De(H),De(T),De(A),C&&C.d(),E&&E.d()}}}function At(e,n,t){var d=["rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(255, 99, 132)","rgb(201, 203, 207)","rgb(220,20,60)","rgb(255,99,71)","rgb(255,69,0)","rgb(154,205,50)","rgb(0,100,0)","rgb(50,205,50)","rgb(0,139,139)","rgb(153,50,204)","rgb(255,105,180)"];let l=null,v=!1,_=!1,s=!1,r=[],a=null,i=[],w=null,D=[],I=null,y="",X="";const de={counter:1,type:"line",data:{datasets:[]},options:{animation:!1,normalized:!0,elements:{point:{radius:0}},responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Time"}},y:{stacked:!0,beginAtZero:!0,title:{display:!0,text:"Power"}}},borderWidth:1,plugins:{zoom:{pan:{enabled:!0,modifierKey:"ctrl",mode:"x"},zoom:{drag:{enabled:!0},wheel:{enabled:!0},mode:"x"}}}}};let V=structuredClone(de);async function he(){l&&(t(11,V=structuredClone(de)),t(5,a=r[0]),t(7,w=i[0]),t(9,I=D[0]),t(1,v=!1),await ce())}async function ce(){if(t(3,s=!0),tt(),a==null||w==null||I==null||l==null){t(3,s=!1);return}let f=Math.floor((I-l.detail.system.reference_year)/l.detail.system.interval_between_years);console.log("Getting energy balance.");let K=await St(l.solution_name,a,w,l.scenario_name,f),ue=await jt(l.solution_name,oe("flow_export",l.version),l.scenario_name);ue===null?y="":y=ue.data[0][0];let R=[],j=0;for(const P in K){let T={node:[a]};if(K[P]==null||K[P].data.length==0)continue;if("technology"in K[P].data[0]){let c=[];for(const q of K[P].data)c.push(q.technology);T={technology:c}}let we={},_e=zt(K[P].data,T,we);if(_e.length!=0)for(let c of _e){if(Object.keys(c.data).length==0)continue;switch(P){case oe("flow_storage_discharge",l.version):c.label=c.label+" (discharge)";break;case oe("flow_transport_in",l.version):c.label=c.label+" (transport in)";break;case oe("flow_import",l.version):c.label="Import",l.version;break;case oe("shed_demand",l.version):c.label="Shed Demand";break;case oe("flow_storage_charge",l.version):c.label=c.label+" (charge)";break;case oe("flow_transport_out",l.version):c.label=c.label+" (transport out)";break;case oe("flow_export",l.version):c.label="Export";break}let q="line";Object.keys(c.data).length==1&&(q="bar"),P=="demand"?(c.label="Demand",c.type="line",c.stack="ownCustomStack",c.fill=!1,c.borderColor="black",c.backgroundColor="white",c.borderWidth=2,c.stepped=!0,Object.keys(c.data).length==1&&(c.pointRadius=2)):(c.type=q,c.fill="origin",c.borderColor=d[j%d.length],c.backgroundColor=d[j%d.length].replace(")",", 1)"),c.stepped=!0,c.cubicInterpolationMode="monotone"),R.push(c),j++}}t(11,V.data.labels=Object.keys(R[0].data),V),t(11,V.data.datasets=R,V),t(11,V.options.scales.y.title.text="Power ["+y+"]",V),t(3,s=!1),t(1,v=!0);let ee=performance.now();await tt();let le=l.solution_name.split(".");t(10,X=[le[(le==null?void 0:le.length)-1],l==null?void 0:l.scenario_name,"balance",w,a,I].join("_")),console.log("Building plot took",performance.now()-ee)}function be(f){i=f,t(6,i)}function G(f){r=f,t(4,r)}function Z(f){D=f,t(8,D)}function Ce(f){l=f,t(0,l)}function ve(f){_=f,t(2,_)}function N(f){D=f,t(8,D)}function S(f){I=f,t(9,I)}function $(f){r=f,t(4,r)}function W(f){a=f,t(5,a)}function x(f){i=f,t(6,i)}function Ie(f){w=f,t(7,w)}function me(f){V=f,t(11,V)}function H(f){X=f,t(10,X)}return[l,v,_,s,r,a,i,w,D,I,X,V,he,ce,be,G,Z,Ce,ve,N,S,$,W,x,Ie,me,H]}class Rt extends rt{constructor(n){super(),dt(this,n,At,qt,it,{})}}export{Rt as component};
